# Binance Order Book Sync

Синхронизация order book с Binance Futures через WebSocket с использованием REST snapshot для инициализации.

action: [run-orderbook](https://github.com/<your-username>/<repo-name>/actions/workflows/run-orderbook.yml)

> ⚠️ **Важно**: GitHub Actions не позволяет обращаться к Binance API из-за ограничений по геолокации. При попытке выполнения workflow через GitHub Actions вы получите ошибку HTTP 451: "Service unavailable from a restricted location". Скрипт необходимо запускать локально или на сервере, расположенном в разрешенном регионе.

## Описание

Скрипт подключается к WebSocket потоку Binance Futures для получения обновлений order book и синхронизирует их с локальным состоянием. Использует REST API snapshot для начальной инициализации и буферизацию событий для обеспечения консистентности данных.

## Пример вывода

```
========================================================================
ORDER BOOK (top 10) | best_bid=77899.0 best_ask=77899.1 spread=0.10000000000582077
------------------------------------------------------------------------
BIDS (price, qty)                  | ASKS (price, qty)
------------------------------------------------------------------------
77899.00  3.011000                 | 77899.10  0.175000
77898.90  0.021000                 | 77899.20  0.008000
77898.80  0.003000                 | 77899.40  0.003000
77898.70  0.002000                 | 77899.80  0.003000
77898.60  0.006000                 | 77899.90  0.004000
77898.50  0.003000                 | 77900.00  0.002000
77898.40  0.002000                 | 77900.10  0.002000
77898.10  0.006000                 | 77900.20  0.005000
77898.00  0.002000                 | 77900.60  0.005000
77897.90  0.002000                 | 77900.70  0.004000
========================================================================
```

## Установка

```bash
pip install requests pydantic websockets
```

## Использование

```bash
python main.py
```

## Настройка

В файле `main.py` можно изменить:
- `SYMBOL` - торговая пара (по умолчанию: `btcusdt`)
- `snapshot_limit` - лимит для snapshot (по умолчанию: 1000)
- `prebuffer_count` - количество событий для предварительного буфера (по умолчанию: 50)
- `print_every_sec` - интервал вывода order book в секундах (по умолчанию: 1.0)
- `top_n` - количество лучших цен для отображения (по умолчанию: 10)
